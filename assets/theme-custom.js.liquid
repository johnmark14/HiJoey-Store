//Custom JavaScript Author: JM
var modal = document.querySelector(".modal");
var trigger = document.querySelector(".trigger");
var closeButton = document.querySelector(".close-button");
var alertClose = document.querySelector(".alert-close");


function toggleModal() {
  modal.classList.toggle("show-modal");
}

function windowOnClick(event) {
  if(event.target === modal) {
    toggleModal();
  }

  if(event.target === alertClose) {
    toggleAlertClose();
  }
}

function toggleAlertClose() {
  post("/contact#contact_form");
}


trigger.addEventListener("click", toggleModal);
closeButton.addEventListener("click", toggleModal);
window.addEventListener("click", windowOnClick);

// Manual Post Method 
function post(path, method="post") {

  const form = document.createElement('form');
  form.method = method;
  form.action = path;
  
  document.body.appendChild(form);
  form.submit();
}

var greet = document.querySelector(".successfull");
var emailContact = document.querySelector("#emailContact");
var btnNotify = document.querySelector("#btn-notify");
var alertMsg = document.querySelector("#alert-msg");
var productTitle = document.querySelector("#product-title").innerHTML;


function openMessage() {
  
  if (emailContact.value.length != 0) {

    try {

      Email.send({
          Host: "smtp.gmail.com",
          Username: "novogamer14@gmail.com",
          Password: "jmBeats14",
          To: emailContact.value,
          Cc: "johnmarkgabrentina@gmail.com",
          From: "Contact@Support.com",
          Subject: "You'll be notified when " + productTitle + " is available",
          Body: "Thanks for registering! You'll receive a notification when this comes back in stock. Please use the code below for an additional 10% off on your next order. [BESTFREN10]"
      }).then( doButton() );
    
    } catch (error) { 
      console.log(error);
    }
  }
  
  return false;
}

function doButton() {
  
  btnNotify.classList.toggle("hide-btn-notify");
  alertMsg.classList.toggle("show-alert");
  emailContact.disabled = true;
}